---
import StatusBadge from './StatusBadge.astro';

interface Props {
  title: string;
  number: number;
  status: string;
  date: Date;
}

const { title, number, status, date } = Astro.props;

const formattedDate = new Date(date).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'short',
  day: 'numeric',
});

const statusColors: Record<string, string> = {
  accepted: 'var(--color-creation)',
  proposed: 'var(--color-discovery)',
  deprecated: '#6c757d',
  superseded: 'var(--color-validation)',
  rejected: '#dc3545',
};
const badgeColor = statusColors[status] || 'var(--color-text-muted)';

// Status icons
const statusIcons: Record<string, string> = {
  accepted: '✓',
  proposed: '?',
  deprecated: '×',
  superseded: '→',
  rejected: '!',
};
const statusIcon = statusIcons[status] || '';
---

<a href={`/adrs/${number}`} class="adr-card" style={`--adr-color: ${badgeColor}`}>
  <div class="adr-header">
    <span class="adr-number">
      #{String(number).padStart(3, '0')}
    </span>
    <div class="adr-title-group">
      <h3 class="adr-title">{title}</h3>
      <span class="adr-status-indicator" title={status}>
        {statusIcon}
      </span>
    </div>
  </div>
  <div class="adr-meta">
    <StatusBadge status={status} />
    <span class="adr-date">{formattedDate}</span>
  </div>
</a>

<style>
  .adr-card {
    display: block;
    padding: var(--space-4);
    border: 1px solid var(--color-border);
    border-left: 4px solid var(--adr-color);
    border-radius: var(--radius-md);
    background: linear-gradient(to right, color-mix(in srgb, var(--adr-color) 3%, transparent) 0%, var(--color-bg) 30%);
    text-decoration: none;
    color: var(--color-text);
    transition: all 0.2s ease;
  }

  .adr-card:hover {
    text-decoration: none;
    border-color: var(--adr-color);
    box-shadow: var(--shadow-md), inset 3px 0 0 color-mix(in srgb, var(--adr-color) 15%, transparent);
  }

  .adr-header {
    display: flex;
    align-items: flex-start;
    gap: var(--space-3);
    margin-bottom: var(--space-3);
  }

  .adr-number {
    flex-shrink: 0;
    font-family: var(--font-mono);
    font-size: var(--text-lg);
    font-weight: 800;
    color: var(--adr-color);
    background: color-mix(in srgb, var(--adr-color) 15%, transparent);
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-md);
    line-height: 1;
    border: 2px solid color-mix(in srgb, var(--adr-color) 30%, transparent);
  }

  .adr-title-group {
    flex: 1;
    display: flex;
    align-items: flex-start;
    gap: var(--space-2);
  }

  .adr-title {
    margin: 0;
    font-size: var(--text-base);
    line-height: 1.4;
    color: var(--color-text);
    font-weight: 600;
    flex: 1;
  }

  .adr-status-indicator {
    flex-shrink: 0;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--text-sm);
    font-weight: 700;
    color: var(--adr-color);
    background: color-mix(in srgb, var(--adr-color) 15%, transparent);
    border-radius: var(--radius-full);
    border: 2px solid color-mix(in srgb, var(--adr-color) 30%, transparent);
  }

  .adr-meta {
    display: flex;
    align-items: center;
    gap: var(--space-2);
    flex-wrap: wrap;
  }

  .adr-date {
    font-size: var(--text-xs);
    color: var(--color-text-muted);
    font-weight: 500;
  }
</style>
